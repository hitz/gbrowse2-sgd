[GENERAL]
description   =  S. cerevisiae from Saccharomyces Genome Database (SGD)
database      = scgenome

initial landmark = chrI:123000..160000

# bring in the special Submitter plugin for the rubber-band select menu                                           
plugins   = FastaDumper RestrictionAnnotator OligoFinder SequenceDumper TrackDumper Submitter BatchDumper
# OligoFinder is BUGGY ATM
autocomplete = 1

# default tracks
default tracks = Landmarks:overview
                 SGD Everything
		 MacIsaac TFBS
		 Tachibana Adr1 Cat8
		 Miura cDNA
		 Zhang TSS
		 Ingolia uORFs
		 Steinmetz Pol II
		 Velculescu SAGE

# examples to show in the introduction
examples = chrIII
	chrV:80,000..120,000
	SGS1
	RPL28
	YCR065W
	flocculation

#	CAATGATTACGGCATT No longer works under gbrowse2

# "automatic" classes to try when an unqualified identifier is given
automatic classes = gene Sequence

# Advanced feature: custom balloons
custom balloons = [balloon]
                  delayTime = 500

                  [balloon500]
	          maxWidth  = 500
                  delayTime = 50

# routines to compile in advance
# NOTE THAT $feature->attributes returns an ARRAY REF in BioPerl 1.6.X/Bio::DB::SeqFeature
# I have added ($var) to all cases; assuming that there will be at most 1 useful value
# Also had to change attribute 'Gene' -> 'gene'
#
# Note (EC): $feature->seqname has been changed to $feature->seq_id as seqname has been
#            deprecated. I have also specified features as type:source where necessary 
#            to distinguish data of the same type from different sources.

#include Gbrowse.initcode.conf

#################################
# database definitions
#################################

#include ../GBrowse.database.local

# Advanced feature: an example of callbacks to bei run remotely
# by gbrowse_details for AJAX/iframe balloons

# Advanced feature:
# Pop up rubberband menus for submitting selected region to search engines...
#include "detail_select_menu.conf"
#include "submitter_plugin.conf"

# Default glyph settings
[TRACK DEFAULTS]
glyph       = generic
database    = scgenome
height      = 8
bgcolor     = cyan
fgcolor     = black
label density = 25
bump density  = 100
show summary  = 99999  # go into summary mode when zoomed out to 100k
# default pop-up balloon
balloon hover = <b>$name</b> is a $type spanning $ref from $start to $end. Click for more details.

### TRACK CONFIGURATION ####
# the remainder of the sections configure individual tracks

[Landmarks:overview]
database        = scgenome
feature		= region:landmark centromere:SGD
glyph		= sub { 
		my $f = shift;
		my $type = $f->type;
		return "dot" if ($type eq "centromere:SGD");
		return "span";
		}
height		= 10
label		= sub {
		my $f = shift;
		my $nm = $f->name;
		return $nm if $nm;
		my ($lid) = $f->attributes('load_id');
		return $lid;
                }
key		= Landmarks

[SGD Everything]
database        = scgenome
feature		= gene:SGD telomere:SGD centromere:SGD ARS:SGD tRNA:SGD rRNA:SGD snoRNA:SGD snRNA:SGD ncRNA:SGD gene_cassette:SGD repeat_region:SGD long_terminal_repeat:SGD LTR_retrotransposon:SGD telomeric_repeat:SGD X_element_combinatorial_repeat:SGD X_element:SGD Y_prime_element:SGD non_transcribed_region:SGD
glyph		= \&rna_glyph
category        = SGD Reference
key		= All Annotated Sequence Features
citation        = All annotated sequence features defined by SGD.
description	= \&feat_desc
fgcolor         = black
bgcolor		= \&orf_color
link		= http://www.yeastgenome.org/cgi-bin/locus.fpl?locus=$name
label		= 1
thin_utr	= 1
balloon hover width = 350
balloon hover   = sub { 
		my $f = shift;
		my $name = $f->name;
		$name =~ s/\"\'//g;
		my ($desc) = $f->attributes('Note');
		$desc =~ s/[\'\"]//g;
		my (@alias) = $f->attributes('alias');
		my ($gene) = $f->attributes('gene');
		my $aliaslist = join(', ', @alias);
		$aliaslist =~ s/$gene\, //;
		$aliaslist =~ s/$gene//;
		my ($orf) = $f->attributes('orf_classification');
		my ($dbxref) = $f->attributes('dbxref');
		my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;
		my $strand = $f->strand;
		my $coord = "$ref\:$beg\.\.$end";
		$coord = "$ref\:$end\.\.$beg" if ($strand == -1);
		my @data;
		push @data, { Key => 'Gene Name:', Value => "$gene" } if $gene;
		push @data, { Key => 'ORF Name:', Value => "$name" };
		push @data, { Key => 'Alias:', Value => "$aliaslist" } if $aliaslist;
		push @data, { Key => 'Classification:', Value => "$orf" } if $orf;
		push @data, { Key => 'SGDID:', Value => "$dbxref" } if $dbxref;
		push @data, { Key => 'Coordinates:', Value => "$coord" };
		push @data, { Key => 'Description:', Value => "$desc" } if $desc;
		hover("Annotated Sequence Feature", \@data);
		}

[SGD Protein-coding Genes]
database        = scgenome
feature		= gene:SGD gene_cassette:SGD transposable_element_gene:SGD
glyph		= gene
category        = SGD Reference
stranded	= 1
strand_arrow	= 1
height		= 8
thin_utr	= 1
key		= Protein-coding Genes
citation        = All protein-coding genes defined by SGD. Verified ORFs are colored in red, uncharacterized in beige and dubious in grey.
description	= \&orf_class
fgcolor         = black
bgcolor		= \&orf_color
link		= http://www.yeastgenome.org/cgi-bin/locus.fpl?locus=$name
label		= 1
balloon hover width = 350
balloon hover	= sub {
		my $f = shift;
		my $name = $f->name;
		$name =~ s/\"\'//g;
		my ($desc) = $f->attributes('Note');
		$desc =~ s/[\'\"]//g;
		my (@alias) = $f->attributes('alias');
		my $aliaslist = join(', ', @alias);
		my ($gene) = $f->attributes('gene');
		$aliaslist =~ s/$gene\, //;
		$aliaslist =~ s/$gene//;
		my ($orf) = $f->attributes('orf_classification');
		my ($dbxref) = $f->attributes('dbxref');
		my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;
		my $strand = $f->strand;
		my $coord = "$ref\:$beg\.\.$end";
		$coord = "$ref\:$end\.\.$beg" if ($strand == -1);
		my @data;
		push @data, { Key => 'Gene Name:', Value => "$gene" } if $gene;
		push @data, { Key => 'ORF Name:', Value => "$name" };
		push @data, { Key => 'Alias:', Value => "$aliaslist" } if $aliaslist;
		push @data, { Key => 'Classification:', Value => "$orf" } if $orf;
		push @data, { Key => 'SGDID:', Value => "$dbxref" } if $dbxref;
		push @data, { Key => 'Coordinates:', Value => "$coord" };
		push @data, { Key => 'Description:', Value => "$desc" } if $desc;
		hover("Protein encoding Gene", \@data);
		}

[SGD RNA Genes]
database        = scgenome
feature		= tRNA:SGD snoRNA:SGD snRNA:SGD rRNA:SGD ncRNA:SGD nc_primary_transcript:SGD
fgcolor		= black
category        = SGD Reference
glyph		= \&rna_glyph
key		= Non-coding RNA Genes
citation        = Non-coding RNA genes as defined by SGD.
description	= \&feat_desc
bgcolor		= \&strand_color
link		= http://www.yeastgenome.org/cgi-bin/locus.fpl?locus=$name
label		= 1
balloon hover width = 350
balloon hover	= sub {
		my $f = shift;
		my $name = $f->name;
		$name =~ s/\"\'//g;
		my ($desc) = $f->attributes('Note');
		$desc =~ s/[\'\"]//g;
		my ($dbxref) = $f->attributes('dbxref');
		my (@alias) = $f->attributes('alias');
		my $aliaslist = join(', ', @alias);
		my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;
		my $strand = $f->strand;
		my $coord = "$ref\:$beg\.\.$end";
		$coord = "$ref\:$end\.\.$beg" if ($strand == -1);
		my @data;
		push @data, { Key => 'Name:', Value => "$name" };
		push @data, { Key => 'Alias:', Value => "$aliaslist" } if $aliaslist;
		push @data, { Key => 'SGDID:', Value => "$dbxref" } if $dbxref;
		push @data, { Key => 'Coordinates:', Value => "$coord" };
		push @data, { Key => 'Description:', Value => "$desc" } if $desc;
		hover("Non-coding RNA Gene", \@data);
		}

[SGD Structural Genes]
database        = scgenome
feature		= telomere:SGD centromere:SGD ARS:SGD repeat_region:SGD telomeric_repeat:SGD X_element_combinatorial_repeat:SGD X_element:SGD Y_prime_element:SGD non_transcribed_region:SGD
fgcolor		= orange
glyph           = box
category        = SGD Reference
key		= Telomere, Centromere and ARS elements
citation        = Telomere, centromere and ARS elements as defined by SGD.
description	= \&feat_desc
bgcolor		= \&strand_color
link		= http://www.yeastgenome.org/cgi-bin/locus.fpl?locus=$name
label		= 1
balloon hover width = 350
balloon hover	= sub {
		my $f = shift;
		my $name = $f->name;
		$name =~ s/\"\'//g;
		my ($desc) = $f->attributes('Note');
		$desc =~ s/[\'\"]//g;
		my (@alias) = $f->attributes('alias');
		my $aliaslist = join(', ', @alias);
		my ($dbxref) = $f->attributes('dbxref');
		my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;
		my $strand = $f->strand;
		my $coord = "$ref\:$beg\.\.$end";
		$coord = "$ref\:$end\.\.$beg" if ($strand == -1);
		my @data;
		push @data, { Key => 'Name:', Value => "$name" };
		push @data, { Key => 'Alias:', Value => "$aliaslist" } if $aliaslist;
		push @data, { Key => 'SGDID:', Value => "$dbxref" } if $dbxref;
		push @data, { Key => 'Coordinates:', Value => "$coord" };
		push @data, { Key => 'Description:', Value => "$desc" } if $desc;
		hover("Telomere, Centromere and ARS elements", \@data);
		}

[SGD Transposable elements]
database        = scgenome
feature		= transposable_element_gene:SGD long_terminal_repeat:SGD LTR_retrotransposon:SGD
glyph		= segments
category        = SGD Reference
bgcolor		= yellow
fgcolor		= black
height		= 6
stranded	= 1
key		= Transposons & Long Terminal Repeats
citation        = Transposons & long terminal repeats as defined by SGD.
description	= \&feat_desc
link		= http://www.yeastgenome.org/cgi-bin/locus.fpl?locus=$name
label		= 1
balloon hover width = 350
balloon hover	= sub {
		my $f = shift;
		my $name = $f->name;
		$name =~ s/\"\'//g;
		my ($desc) = $f->attributes('Note');
		$desc =~ s/[\'\"]//g;
		my (@alias) = $f->attributes('alias');
		my $aliaslist = join(', ', @alias);
		my ($dbxref) = $f->attributes('dbxref');
		my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;
		my $strand = $f->strand;
		my $coord = "$ref\:$beg\.\.$end";
		$coord = "$ref\:$end\.\.$beg" if ($strand == -1);
		my @data;
		push @data, { Key => 'Name:', Value => "$name" };
		push @data, { Key => 'Alias:', Value => "$aliaslist" } if $aliaslist;
		push @data, { Key => 'SGDID:', Value => "$dbxref" } if $dbxref;
		push @data, { Key => 'Coordinates:', Value => "$coord" };
		push @data, { Key => 'Description:', Value => "$desc" } if $desc;
		hover("Transposons & Long Terminal Repeats", \@data);
		}

[SGD TranslationF]
database        = scgenome
glyph		= translation
category        = SGD Reference
global feature	= 1
frame0		= cadetblue
frame1		= blue
frame2		= darkblue
height		= 20
fgcolor		= purple
strand		= +1
translation	= 3frame
start_codons	= 0
key		= 3-frame translation (forward)
codontable	= \&codontable_check
citation	= This track shows the position of stop codons at low magnifications,
		and the 3-frame translation at high magnifications. Only the forward strand
		is shown.

[SGD DNA/GC Content]
database        = scgenome
glyph		= dna
category        = SGD Reference
global feature	= 1
height		= 30
do_gc		= 1
fgcolor		= red
axis_color	= blue
strand		= both
key		= DNA/GC Content

[SGD TranslationR]
database        = scgenome
glyph		= translation
category        = SGD Reference
global feature	= 1
frame0		= darkred
frame1		= red
frame2		= crimson
height		= 20
fgcolor		= blue
strand		= -1
translation	= 3frame
start_codons	= 0
key		= 3-frame translation (reverse)
codontable	= \&codontable_check
citation	= This track shows the position of stop codons at low magnifications,
		and the 3-frame translation at high magnifications. Only the reverse
		strand is shown.

[ResGen PCR Primers]
database        = scgenome
feature		= primer:ResGen
category        = SGD Reference
fgcolor		= purple
glyph		= segments
key		= ResGen primers
citation        = Primer sequences that were distributed by Invitrogen/Research Genetics. These primers are unfortunately no longer commercially available but are provided here for archival purposes.
description	= \&pcr_desc
bgcolor		= purple
link		= AUTO
label		= 1
balloon hover width = 350
balloon hover	= sub {
		my $f = shift;
		my $name = $f->name;
		$name =~ s/\"\'//g;
		my ($desc) = $f->attributes('Note');
		$desc =~ s/[\'\"]//g;
		my ($seq) = $f->attributes('Sequence');
		my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;
		my $length = $f->length . " bp";
		my @data;
		push @data, { Key => 'Name:', Value => "$name" };
		push @data, { Key => 'Sequence:', Value => "$seq" };
		push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
		push @data, { Key => 'Length:', Value => "$length" };
		push @data, { Key => 'Description:', Value => "$desc" } if $desc;
		hover("ResGen Primer", \@data);
		}

[SGD PCR Products]
database        = scgenome
feature		= PCR_product:ResGen
glyph		= primers
category        = SGD Reference
bgcolor		= purple
key		= ResGen primer products
citation        = PCR products derived from primer sequences that were distributed by Invitrogen/Research Genetics. These primers are unfortunately no longer commercially available but are provided here for archival purposes.
description	= \&pcr_desc
link		= AUTO
label		= 1
balloon hover width = 350
balloon hover	= sub {
		my $f = shift;
		my $name = $f->name;
		$name =~ s/\"\'//g;
		my ($desc) = $f->attributes('Note');
		$desc =~ s/[\'\"]//g;
		my $ref = $f->seqname;
		my $beg = $f->start;
		my $end = $f->end;
		my @data;
		push @data, { Key => 'Name:', Value => "$name" };
		push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
		push @data, { Key => 'Description:', Value => "$desc" } if $desc;
		hover("Predicted PCR products from ResGen primers", \@data);
		}

[SGD Clones]
feature		= clone
fgcolor		= black
glyph		= generic
category        = SGD Reference
key		= Genomic Clones
height		= 5
description	= 1
bgcolor		= black
link		= http://www.yeastgenome.org/cgi-bin/clone.pl?clone=$name
citation	= <b>Riles L, Dutchik JE, Baktha A, McCauley BK, Thayer EC, Leckie MP, Braden VV, Depke JE, Olson MV. (1993) Physical maps of the six smallest chromosomes of Saccharomyces cerevisiae at a resolution of 2.6 kilobase pairs. Genetics 134:81-150 <a href="http://www.ncbi.nlm.nih.gov/pubmed/8514151">[PMID:8514151]</a></b><br/><br/>Lambda and cosmid clones created and mapped by Olson and Riles at WashU.
label		= 1
balloon hover width = 350
balloon hover	= sub {
		my $f = shift;
		my $name = $f->name;
		$name =~ s/\"\'//g;
		$name = "ATCC:$name";
		my ($desc) = $f->attributes('Note');
		$desc =~ s/[\'\"]//g;
		my (@alias) = $f->attributes('alias');
		my $aliaslist = join(', ', @alias);
		my ($dbxref) = $f->attributes('dbxref');
		my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;
		my $length = $f->length . " bp";
		my @data;
		push @data, { Key => 'Name:', Value => "$name" };
		push @data, { Key => 'Alias:', Value => "$aliaslist" } if $aliaslist;
		push @data, { Key => 'SGDID:', Value => "$dbxref" } if $dbxref;
		push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
		push @data, { Key => 'Length:', Value => "$length" };
		push @data, { Key => 'Description:', Value => "$desc" } if $desc;
		hover("Genomic Clone", \@data);
		}

[MacIsaac TFBSs]
database        = encode
feature         = TF_binding_site:MacIsaac_2005
category        = Transcription Regulation:Transcription Factors
fgcolor         = black
glyph           = diamond
key             = TF ChIP chip: MacIsaac et al. (2005)
height          = 6
bgcolor         = orange
label           = 1
link            = \&TF_url
citation        = <b>MacIsaac KD, Wang T, Gordon DB, Gifford DK, Stormo GD, Fraenkel E (2006) An improved map of conserved regulatory sites for Saccharomyces cerevisiae. BMC Bioinformatics. Mar 7;7:113. 
                  <a href="http://www.ncbi.nlm.nih.gov/pubmed/16522208">[PMID: 16522208]</a></b><br/><br/>
                   MacIsaac et al. re-analyzed the Harbison et al. (2004, PMID: 15343339) ChIP-chip analysis to determine the binding locations of 203 regulatory proteins across the budding yeast genome.
                   These features represent binding sites determined from the ChIP-chip data of Harbison et al. (2004) at the most stringent binding p-value cutoff (0.001) and conservation cutoff studied.
balloon hover width = 350
balloon hover   = sub {
                 my $f = shift;
                 my $name = $f->name;
                 $name =~ s/\"\'//g;
                 my ($desc) = $f->attributes('Note');
                 $desc =~ s/[\'\"]//g;
                 my $ref = $f->seq_id;
                 my $beg = $f->start;
                 my $end = $f->end;
                 my $length = $f->length . " bp";
                 my @data;
                 push @data, { Key => 'Description:', Value => "$desc" };
                 push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                 push @data, { Key => 'Site Length:', Value => "$length" };
                 hover("Source: MacIsaac et al. (2006) BMC Bioformatics   Mar 7;7:113", \@data);
                 }

[Tachibana Adr1 Cat8]
database        = encode
feature		= microarray_oligo:Tachibana_2005
category	= Transcription Regulation:Transcription Factors
fgcolor		= black
glyph		= diamond
key		= Adr1 and Cat8 ChIP chip: Tachibana et al. (2005)
height		= 6
bgcolor		= orange
description	= 1
link		= AUTO
citation	= <b>Tachibana C, Yoo JY, Tagne JB, Kacherovsky N, Lee TI, Young ET (2005) Combined global localization analysis and transcriptome data identify genes that are directly coregulated by Adr1 and Cat8. Mol Cell Biol 25(6):2138-46 
                  <a href="http://www.ncbi.nlm.nih.gov/pubmed/15743812">[PMID:15743812]</a></b><br/><br/>
                  Tachibana et al. examined the combinatorial regulation by transcription factors Adr1 and Cat8 genome-wide in Saccharomyces cerevisiae during glucose depletion using ChIP-chip. These features describe the ChIP-chip localization
                  data for transcription factors Adr1 and Cat8 respectively.
label		= 1
balloon hover width = 350
balloon hover	= sub {
		my $f = shift;
		my $name = $f->name;
		$name =~ s/\"\'//g;
		$name =~ s/-/ /g;
		my ($desc) = $f->attributes('Note');
		$desc =~ s/[\'\"]//g;
		my ($dbxref) = $f->attributes('dbxref');
		my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;
		my $length = $f->length . " bp";
		my @data;
		push @data, { Key => 'Description:', Value => "$name" };
		push @data, { Key => 'SGDID:', Value => "$dbxref" } if $dbxref;
		push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
		push @data, { Key => 'ChIP-CHIP hit to:', Value => "$desc" } if $desc;
		push @data, { Key => 'CHIP spot Length:', Value => "$length" };
		hover("Source: Tachibana et al. (2005) MCB 25:2138-2146", \@data);
		}

[Ingolia uORFs]
database    = encode
feature     = biological_region:Ingolia_2009
glyph       = christmas_arrow
category    = Other
stranded    = 1
fgcolor     = darkviolet
bgcolor     = darkviolet
label       = 1
category    = Transcription Regulation:Other
key         = uORFs: Ingolia et al. (2009)
citation	= <b>Ingolia NT, Ghaemmaghami S, Newman JR, Weissman JS. (2009) Genome-wide analysis in vivo of translation with nucleotide resolution using ribosome profiling. Science 324(5924):218-23. 
                  <a href="http://www.ncbi.nlm.nih.gov/pubmed/19213877">[PMID:19213877]</a></b><br/><br/>
                  Ingolia et al. developed a ribosome-profiling method based on deep sequencing of ribosome-protected fragments to study translation with subcodon resolution in S. cerevisiae under both
                  rich and starvation conditions.<br/><br/>
                  Canonical upstream ORFs (uORFs) were identified by finding AUG codons within annotated 5'UTRs and determination of the following open reading frame. Footprints were assigned to uORFs when
                  they started no more than 14 nucleotides before the start of the uORF, and ended no more than 15 nucleotides before the end of the uORF or 21 nucleotides before the start of the downstream
                  protein-coding gene. "Initiation context scores were computed using a weight matrix model devised by Miyasaka (Yeast, 1999) based on the start codon context of highly-expressed genes. 
                  The weight matrix scores six nucleotides before the start codon as well as three nucleotides after."
balloon hover	= sub {
		my $f = shift;
		my $name = $f->name;
                my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;
                my ($downstream_ORF) = $f->attributes('downstream_ORF');
                #my ($num_footprints) = $f->attributes('num_uORF_ribosome_footprints');
  		my @data;
                push @data, { Key => 'Description:', Value => "uORF for $downstream_ORF" };
		push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                push @data, { Key => 'Downstream ORF:', Value => "$downstream_ORF" };
                #push @data, { Key => '# uORF ribosome footprints:', Value => "$num_footprints" };
               	hover("Source: Ingolia et al. (2009) Science 324(5924):218-23", \@data);
                }

[Velculescu SAGE]
database        = encode
feature		= SAGE_tag:Velculescu_1997
glyph		= generic
bgcolor		= green
height		= 6
category	= RNA Expression Profiling:mRNA:SAGE
key		= SAGE tags: Velculescu et al. (1997)
citation        = <b>Velculescu VE, Zhang L, Zhou W, Vogelstein J, Basrai MA, Bassett DE Jr, Hieter P, Vogelstein B, Kinzler KW. (1997) Characterization of the yeast transcriptome. Characterization of the yeast transcriptome.
                  <a href="http://www.ncbi.nlm.nih.gov/pubmed/9008165">[PMID:9008165]</a></b><br/><br/>
                  Velculescu et al. performed SAGE analysis of the yeast transcriptome.
link		= AUTO
description	= \&pcr_desc
label		= \&seq_name
label		= 1
balloon hover width = 350
balloon hover	= sub {
		my $f = shift;
		my $name = $f->name;
		$name =~ s/\"\'//g;
		my ($desc) = $f->attributes('Note');
		my ($hits) = $f->attributes('total_hit_count');
		my (@others) = $f->attributes('other_hit_coordinates');
		my $other_coords = join(', ', @others);
		$desc =~ s/[\'\"]//g;
		my (@alias) = $f->attributes('alias');
		my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;
		my $length = $f->length . " bp";
		my @data;
		push @data, { Key => 'Sequence:', Value => "$name" };
		push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
		push @data, { Key => 'Length:', Value => "$length" };
		push @data, { Key => 'Matches in Genome:', Value => "$hits" } if $hits;
		push @data, { Key => 'Other Coordinates:', Value => "$other_coords" } if $other_coords;
		push @data, { Key => 'Description:', Value => "$desc" } if $desc;
		hover("Source: Velculescu et al. (1997) Cell 88:243-51", \@data);
		}

[Steinmetz Pol II]
database        = Steinmetz_PolII_BigWig
feature         = ChIP_chip
category	= Transcription Regulation:RNA Pol II ChIP
glyph		= wiggle_xyplot
graph_type      = histogram
fgcolor         = black
bgcolor		= sub {
		  my $f = shift;
		  my ($strain) = $f->attributes('strain');
		  if ($strain eq "sen1_mutant") {
		    return "green";
		  } else {
		    return "blue:0.15";
		  }
		}
height		= 70
min_score	= -1
max_score	= 1
scale		= right
key		= Pol II occupancy: Steinmetz et al. (2006)
bump		= 0
link		= http://www.yeastgenome.org/cgi-bin/reference/reference.pl?pubmed=17157256
citation	= <b>Steinmetz EJ, Warren CL, Kuehner JN, Panbehi B, Ansari AZ, and Brow DA (2006) Genome-wide distribution of yeast RNA polymerase II and its control by Sen1 helicase. Molecular Cell 24(5):735-746
                  <a href="http://www.ncbi.nlm.nih.gov/pubmed/17157256">[PMID:17157256]</a></b><br/><br/>
                  Steinmetz et al. constructed a high-resolution map of RNA polymerase II occupancy across the entire yeast genome using ChIP-chip technology in wildtype and sen1 mutant strains. The Sen1 helicase
                  is a RNA polymerase II termination factor for noncoding RNA genes. This track shows the genome-wide distribution of RNA polymerase II in the wildype (blue) and sen1 mutant strains (green).
balloon hover width = 350
balloon hover	= sub {
		my @data;
		push @data, { Key => 'Blue:', Value => "Wildtype Pol II enrichment. SEN1, MATalpha cells" };
                push @data, { Key => 'Green:', Value => "sen1 mutant enrichment. sen1-E1579K, MATa cells" };
		push @data, { Key => 'NCBI/GEO accession:', Value => "GPL4563, GSE6293" };
		hover("Source: Steinmetz et al (2006) Molecular Cell 24(5):735-746", \@data);
		}
group_on        = source

[Miura cDNA]
database        = encode
feature		= cDNA_clone:Miura_2006
bgcolor		= \&transcript_hit;
fgcolor		= \&transcript_hit;
glyph		= transcript2
height		= 5
category	= Gene Structure:cDNA
key		= cDNA transcripts: Miura et al. (2006)
description	= 1
link		= AUTO
citation	= <b>Miura F, Kawaguchi N, Sese J, Toyoda A, Hattori M, Morishita S, Ito T (2006) A large-scale full-length cDNA analysis to explore the budding yeast transcriptome. Proc Natl Acad Sci U S A 103(47):17846-51 
                  <a href="http://www.ncbi.nlm.nih.gov/pubmed/17101987">[PMID:17101987]</a></b><br/><br/>
                  Miura et al. used a "vector-capping" method to perform a large-scale sequencing of cDNA clones in budding yeast cells exponentially growing in minimal media and meiotic cells, resulting in two cDNA libraries.
                  This track describes the 51,026 cDNA clones analyzed in their study.
label		= 0
balloon hover width = 350
balloon hover	= sub {
		my $f = shift;
		my ($poly) = $f->attributes('3\'-end_judgement');
		my ($assign) = $f->attributes('assignment');
		my (@assocFeat) = $f->attributes('associated_feature');
		my ($List) = join(', ', @assocFeat);
		my ($URL);
		my @allFeat;
		foreach (@assocFeat) {
		    my ($ORF, @desc) = split/\s/;
		    if ($ORF =~ /^Y[A-P][LR]\d{3}/) {
			$URL = "<a href=http://link.utgenome.org/yeast_sgd.php?orfname=".$ORF."&version=200601>".$ORF."</a>";
			push(@allFeat, $URL);
		    } 
		}
		my ($allURL) = join(',', @allFeat);
		my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;
		my @data;
		if ($end - $beg < 2001) {
		    my $strand = $f->strand;
		    my $coord = "$ref\:$beg\.\.$end";
		    $coord = "$ref\:$end\.\.$beg" if ($strand == -1);
		    push @data, { Key => '3\'-end:', Value => "$poly" } if $poly;
		    push @data, { Key => 'cDNA hit:', Value =>"$assign" } if $assign;
		    push @data, { Key => 'Feature(s):', Value => "$List" } if $List;
		    push @data, { Key => 'Coordinates:', Value => "$coord" } if $coord;
		    push @data, { Key => 'Oranges:', Value => "cDNAs with a perfect G-cap.<br>Dark: cDNA hit is unique<br>Light: cDNA hits multiple genomic locations" };
		    push @data, { Key => 'Blues:', Value => "cDNAs without a perfect G-cap.<br>Dark: cDNA hit is unique<br>Light: cDNA hits multiple genomic locations" };
		    push @data, { Key => 'More info:', Value => "Regions with >100 cDNAs are summarized as a single bar. Histogram view available for regions >20 kb." };
		    push @data, { Key => 'Additional data:', Value => "View $allURL at the UT Genome Browser." } if $allURL;
		} else {
		    push @data, { Key => 'Histogram:', Value => "The histogram shows the number of transcripts found in each region.  To view transcripts, select a region smaller than 20 kb." }
	        }
		hover("Source: Miura et al. (2006) Proc Natl Acad Sci U S A 103(47):17846-51", \@data);
	        }

[Miura cDNA:20001]
database        = encode
feature		= cDNA_match:Miura_2006
glyph		= xyplot
graph_type	= boxes
bgcolor		= darkgreen
height		= 60
scale		= right
bump		= 0
group_on        = source

[Zhang TSS]
database        = encode
feature		= TSS:Zhang_2005
fgcolor		= orangered
glyph		= arrow
parallel	= 0
northeast	= 1
height		= 6
linewidth	= 2
category	= Gene Structure:Gene Models:TSS
key		= Transcription start sites: Zhang and Dietrich (2005)
citation	= <b>Zhang Z, Dietrich FS (2005) Mapping of transcription start sites in Saccharomyces cerevisiae using 5\' SAGE. Nucleic Acids Res 33(9):2838-51 
                  <a href="http://www.ncbi.nlm.nih.gov/pubmed/15905473">[PMID:15905473]</a></b><br/><br/>
                  Zhang et al. used 5' SAGE to identify the first 15-17 bases of transcripts in S. cerevisiae W303-1A, creating tags that are ligated to form 
                  ditags, amplified, concatemerized and ligated into a vector to create a library. This track contains the transcription start sites identified in their study.
label		= 0
link		= AUTO
balloon hover width = 350
balloon hover	= sub {
		my $f = shift;
		my ($freq) = $f->attributes('frequency');
		my ($assocFeat) = $f->attributes('associated_orf');
		my $ref = $f->seq_id;
		my $beg = $f->start;
		my $strand = $f->strand;
		my $coord = "$ref\:$beg";
		my @data;
		push @data, { Key => 'Frequency of occurrence:', Value => "$freq" };
		push @data, { Key => 'Associated ORF:', Value => "$assocFeat" };
		push @data, { Key => 'Coordinate:', Value => "$coord" };
		push @data, { Key => 'Title:', Value => "Mapping of transcription start sites in Saccharomyces cerevisiae using 5\' SAGE." };
		hover("Source: Zhang and Dietrich (2005) Nucleic Acids Res 33(9):2838-51", \@data);
		}
	
### Yeast modENCODE tracks ###

## Transcriptome ##

[Nagalakshmi 2008 UTRs]
database        = encode
feature         = five_prime_UTR:Nagalakshmi_2008 three_prime_UTR:Nagalakshmi_2008
glyph           = segments
stranded        = 1
bgcolor         = green
fgcolor         = black
label           = 1
height          = 6
category        = Gene Structure:UTRs
key             = 5' and 3' UTRs: Nagalakshmi et al. (2008)
citation	= <b>Nagalakshmi U, Wang Z, Waern K, Shou C, Raha D, Gerstein M, Snyder M. (2008) The transcriptional landscape of the yeast genome defined by RNA sequencing. Science 320(5881):1344-9. 
                  <a href="http://www.ncbi.nlm.nih.gov/pubmed/18451266">[PMID:18451266]</a></b><br/><br/>
                  Nagalakshmi et al. developed high-throughput sequencing based method for mapping transcribed regions (RNA-seq) and used it to generate a high-resolution transcriptome map of the budding yeast genome. 
                  These features represent 5' and 3' UTR boundaries defined by a computational algorithm applied to the RNA-seq data.
balloon hover	= sub {
		my $f = shift;
		my $name = $f->name;
                my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;
                my ($log2_expr) = $f->attributes('log2_transcription_level');
		my @data;
		push @data, { Key => 'Description:', Value => "$name" };
		push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                push @data, { Key => 'log2 expression level:', Value => "$log2_expr" };
               	hover("Source: Nagalakshmi et al. (2008) Science 320(5881):1344-9", \@data);
                }

[Nagalakshmi 2008 predicted transcripts]
database         = encode
feature          = transcript:Nagalakshmi_2008
glyph            = transcript
stranded         = 1
bgcolor          = magenta
fgcolor          = black
height           = 6
label            = 1
description      = 0
thin_utr         = 1
decorate_introns = 1
category         = RNA Expression Profiling:Unannotated:RNA-seq
key              = Unannotated transcripts: Nagalakshmi et al. (2008)
citation	= <b>Nagalakshmi U, Wang Z, Waern K, Shou C, Raha D, Gerstein M, Snyder M. (2008) The transcriptional landscape of the yeast genome defined by RNA sequencing. Science 320(5881):1344-9.
                  <a href="http://www.ncbi.nlm.nih.gov/pubmed/18451266">[PMID:18451266]</a></b><br/><br/>
                  Nagalakshmi et al. developed high-throughput sequencing based method for mapping transcribed regions (RNA-seq) and used it to generate a high-resolution transcriptome map of the budding yeast genome.
                  These features represent novel gene predictions based on RNA-seq.
balloon hover	= sub {
		my $f = shift;
		my $name = $f->name;
                my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;
            	my @data;
		push @data, { Key => 'Description:', Value => "Predicted transcript: $name" };
		push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                hover("Source: Nagalakshmi et al. (2008) Science 320(5881):1344-9", \@data);
                }

[Nagalakshmi 2008 confirmed introns]
database = encode
feature  = intron:Nagalakshmi_2008
glyph    = generic
stranded = 0
bgcolor  = magenta
fgcolor  = black
height   = 6
category = Gene Structure:Gene Models:Introns
key      = Verified introns: Nagalakshmi et al. (2008)
citation	= <b>Nagalakshmi U, Wang Z, Waern K, Shou C, Raha D, Gerstein M, Snyder M. (2008) The transcriptional landscape of the yeast genome defined by RNA sequencing. Science 320(5881):1344-9. 
                  <a href="http://www.ncbi.nlm.nih.gov/pubmed/18451266">[PMID:18451266]</a></b><br/><br/>
                  Nagalakshmi et al. developed high-throughput sequencing based method for mapping transcribed regions (RNA-seq) and used it to generate a high-resolution transcriptome map of the budding yeast genome.
                  These features represent introns detected by a computational algorithm applied to the RNA-seq data.
balloon hover	= sub {
		my $f = shift;
		my $name = $f->name;
                my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;
                my ($tag_count) = $f->attributes('tag_count');
		my @data;
		push @data, { Key => 'Description:', Value => "Intron $name" };
		push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                push @data, { Key => 'Tag count:', Value => "$tag_count" };
               	hover("Source: Nagalakshmi et al. (2008) Science 320(5881):1344-9", \@data);
                }

[Xu 2009 ORF_Ts]
database    = encode
feature     = transcript:Xu_2009_ORFs
glyph       = transcript
stranded    = 1
fgcolor     = black
bgcolor     = magenta
height      = 6
label       = 1
category    = RNA Expression Profiling:mRNA:Tiling Array
key         = Known transcripts: Xu et al. (2009)
citation    = <b>Xu Z, Wei W, Gagneur J, Perocchi F, Clauder-M&uuml;nster S, Camblong J, Guffanti E, Stutz F, Huber W, Steinmetz LM. (2009) Bidirectional promoters generate pervasive transcription in yeast. Nature 457(7232):1033-7. 
              <a href="http://www.ncbi.nlm.nih.gov/pubmed/19169243">[PMID:19169243]</a></b><br/><br/>Xu et al. used tiling arrays to profile the transcriptomes of wildtype budding yeast in ethanol (YPE), glucose (YPD, SDC) and galactose (YPGal) to comprehensively survey the structure and expression level of transcripts across the yeast genome. These transcripts, termed ORF-Ts were classified by the authors as such if they overlapped with a verified or uncharacterized ORF as annotated in SGD. 
balloon hover = sub {
		my $f = shift;
                my $id = $f->load_id;
		my $name = $f->name;
                my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;

                my @tags = $f->get_all_tags;
                
                # For some reason the order of the tags is all jumbled up. (e.g. $tag[4] is load_id)
                #my ($end_conf) = $f->get_tag_values($tags[0]);
                #my ($source) = $f->get_tag_values($tags[1]);
                my ($div_5NFR) = $f->get_tag_values($tags[5]);
                my ($tan_5NFR) = $f->get_tag_values($tags[2]);
                my ($init_3NFR_opp) = $f->get_tag_values($tags[3]);
                my ($init_3NFR_same) = $f->get_tag_values($tags[6]);

            	my @data;
                push @data, { Key => 'Description:', Value => "$name ($id)" };
		push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                push @data, { Key => 'Shares 5\'NFR in divergent configuration with:', Value => "$div_5NFR" };
                push @data, { Key => 'Shares 5\'NFR in tandem with:', Value => "$tan_5NFR" };
                push @data, { Key => 'Initiates from 3\'NFR of and opposite strand to:', Value => "$init_3NFR_opp" };
                push @data, { Key => 'Initiates from 3\'NFR of and same strand to:', Value => "$init_3NFR_same" };
                hover("Source: Xu et al. (2009) Nature 457(7232):1033-7", \@data);
                }

[Xu 2009 CUTs]
database  = encode
feature   = transcript:Xu_2009_CUTs
glyph     = transcript
bgcolor   = black
fgcolor   = gray
label     = 1
stranded  = 1
height    = 6
connector = solid
category    = RNA Expression Profiling:ncRNA:Tiling Array
key         = CUTs: Xu et al. (2009)
citation    = <b>Xu Z, Wei W, Gagneur J, Perocchi F, Clauder-M&uuml;nster S, Camblong J, Guffanti E, Stutz F, Huber W, Steinmetz LM. (2009) Bidirectional promoters generate pervasive transcription in yeast. Nature 457(7232):1033-7. 
              <a href="http://www.ncbi.nlm.nih.gov/pubmed/19169243">[PMID:19169243]</a></b><br/><br/>
              Xu et al. used tiling arrays to profile the transcriptomes of wildtype budding yeast in ethanol (YPE), glucose (YPD, SDC) and galactose (YPGal) to comprehensively survey the structure and expression level of transcripts across the yeast genome. 
              These cryptic unstable transcripts (CUTs) were classified as such if they 
              <ol>
                <li> did not overlap with any annotated SGD features,
                <li> show higher than two-fold expression in rrp6delta compared to WT, and
                <li> were at least 100 bases long.
              </ol>
              Two types of CUTs were defined (from methods): "The first type were rrp6delta segments that did not overlap any manually curated segments and fulfilled all 3 criteria. The second time were derived from rrp6delta segments overlapping 
              manually curated transcripts in either a one-to-one or many-to-one relationship. The rrp6delta-specific (non-overlapping) parts of these segments were classified as CUTs if they fulfilled all criteria."
balloon hover = sub {
		my $f = shift;
                my $id = $f->load_id;
		my $name = $f->name;
                my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;

                my @tags = $f->get_all_tags;

                # For some reason the order of the tags is all jumbled up. (e.g. $tag[4] is load_id)
                #my ($end_conf) = $f->get_tag_values($tags[0]);
                #my ($source) = $f->get_tag_values($tags[1]);
                my ($div_5NFR) = $f->get_tag_values($tags[5]);
                my ($tan_5NFR) = $f->get_tag_values($tags[2]);
                my ($init_3NFR_opp) = $f->get_tag_values($tags[3]);
                my ($init_3NFR_same) = $f->get_tag_values($tags[6]);

            	my @data;
                push @data, { Key => 'Description:', Value => "$name ($id)" };
		push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                push @data, { Key => 'Shares 5\'NFR in divergent configuration with:', Value => "$div_5NFR" };
                push @data, { Key => 'Shares 5\'NFR in tandem with:', Value => "$tan_5NFR" };
                push @data, { Key => 'Initiates from 3\'NFR of and opposite strand to:', Value => "$init_3NFR_opp" };
                push @data, { Key => 'Initiates from 3\'NFR of and same strand to:', Value => "$init_3NFR_same" };
                hover("Source: Xu et al. (2009) Nature 457(7232):1033-7", \@data);
                }

[Xu 2009 SUTs]
database  = encode
feature   = transcript:Xu_2009_SUTs
glyph     = transcript
bgcolor   = black
fgcolor   = gray
label     = 1
stranded  = 1
height    = 6
connector = solid
category    = RNA Expression Profiling:ncRNA:Tiling Array
key         = SUTs: Xu et al. (2009)
citation    = <b>Xu Z, Wei W, Gagneur J, Perocchi F, Clauder-M&uuml;nster S, Camblong J, Guffanti E, Stutz F, Huber W, Steinmetz LM. (2009) Bidirectional promoters generate pervasive transcription in yeast. Nature 457(7232):1033-7. 
              <a href="http://www.ncbi.nlm.nih.gov/pubmed/19169243">[PMID:19169243]</a></b><br/><br/>
              Xu et al. used tiling arrays to profile the transcriptomes of wildtype budding yeast in ethanol (YPE), glucose (YPD, SDC) and galactose (YPGal) to comprehensively survey the structure and expression level of transcripts across the yeast genome. 
              Stable unannotated transcripts (SUTs) were classified as such if they did not overlap with existing annotation in SGD and exist stably in cells.
balloon hover = sub {
		my $f = shift;
                my $id = $f->load_id;
		my $name = $f->name;
                my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;

                my @tags = $f->get_all_tags;

                # Order of the tags in the tags array
                #tag0 = source
                #tag1 = sense_anti_pair_with
                #tag2 = end_confidence
                #tag3 = init_from_3NFR_opp_from
                #tag4 = expr_SUT_sense_anti_with
                #tag5 = load_id
                #tag6 = expr_SUT_sharing_5NFR_in_YPE/YPD
                #tag7 = init_from_3NFR_of_and_same_strand_to
                #tag8 = expr_SUT_in_sense_anti_
                #tag9 = expr_in_YPE/YPD
                #tag10 = $tan_5NFR
                #tag11 = expr_in_YPGal/YPD
                #tag12 = expr_SUT_sharing_5NFR_in_YPGal/YPD
                #tag13 = shares_5NFR_divergent
           
                my ($source) = $f->get_tag_values($tags[0]);
                my ($sense_anti) = $f->get_tag_values($tags[1]);
                my ($end_conf) = $f->get_tag_values($tags[2]);
                my ($init_3NFR_opp) = $f->get_tag_values($tags[3]);
                my ($expr_SUT_sense_anti_YPE_YPD) = $f->get_tag_values($tags[4]);
                my ($id) = $f->get_tag_values($tags[5]);
                my ($expr_SUT_5NFR_YPE_YPD) = $f->get_tag_values($tags[6]);
                my ($init_3NFR_same) = $f->get_tag_values($tags[7]);
                my ($expr_SUT_sense_anti_YPGal_YPD) = $f->get_tag_values($tags[8]);
                my ($expr_in_YPE_YPD) = $f->get_tag_values($tags[9]);
                my ($tan_5NFR) = $f->get_tag_values($tags[10]);
                my ($expr_in_YPGal_YPD) = $f->get_tag_values($tags[11]);
                my ($expr_SUT_5NFR_YPGal_YPD) = $f->get_tag_values($tags[12]);
                my ($div_5NFR) = $f->get_tag_values($tags[13]);

                my @data;
                
                push @data, { Key => 'Description:', Value => "$name ($id)" };
		push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                push @data, { Key => 'Shares 5\'NFR in divergent configuration with:', Value => "$div_5NFR" };
                push @data, { Key => 'Shares 5\'NFR in tandem with:', Value => "$tan_5NFR" };
                push @data, { Key => 'Initiates from 3\'NFR of and opposite strand to:', Value => "$init_3NFR_opp" };
                push @data, { Key => 'Initiates from 3\'NFR of and same strand to:', Value => "$init_3NFR_same" };
                push @data, { Key => 'Sense-antisense pair with:', Value => "$sense_anti" };
                push @data, { Key => 'Expression in YPE\/YPD:', Value => "$expr_in_YPE_YPD" };
                push @data, { Key => 'Expression in YPGal\/YPD:', Value => "$expr_in_YPGal_YPD" };
                push @data, { Key => 'Expression of SUT in sense-antisense pair in YPE\/YPD:', Value => "$expr_SUT_sense_anti_YPE_YPD" };
                push @data, { Key => 'Expression of SUT in sense-antisense pair in YPGal\/YPD:', Value => "$expr_SUT_sense_anti_YPGal_YPD" };
                push @data, { Key => 'Expression of SUT sharing 5\'NFR in YPE\/YPD:', Value => "$expr_SUT_5NFR_YPE_YPD" };
                push @data, { Key => 'Expression of SUT sharing 5\'NFR in YPGal\/YPD:', Value => "$expr_SUT_5NFR_YPGal_YPD" };
                hover("Source: Xu et al. (2009) Nature 457(7232):1033-7", \@data);
                }

[Xu 2009 other transcripts]
database  = encode
feature   = transcript:Xu_2009_other
glyph     = transcript
bgcolor   = black
fgcolor   = gray
label     = 1
stranded  = 1
height    = 6
connector = solid
category    = RNA Expression Profiling:Unannotated:Tiling Array
key         = Unannotated transcripts: Xu et al. (2009)
citation    = <b>Xu Z, Wei W, Gagneur J, Perocchi F, Clauder-M&uuml;nster S, Camblong J, Guffanti E, Stutz F, Huber W, Steinmetz LM. (2009) Bidirectional promoters generate pervasive transcription in yeast. Nature 457(7232):1033-7.
              <a href="http://www.ncbi.nlm.nih.gov/pubmed/19169243">[PMID:19169243]</a></b><br/><br/>
              Xu et al. used tiling arrays to profile the transcriptomes of wildtype budding yeast in ethanol (YPE), glucose (YPD, SDC) and galactose (YPGal) to comprehensively survey the structure and expression level of transcripts across the yeast genome.
              Transcripts were classified as "other" if they were not:
              <ol>
                <li> SUTs (no overlap with existing SGD annotation)
                <li> ORF-Ts (overlaped with a verified or uncharacterized open reading frame in SGD)
                <li> CUTs (cryptic unstable transcripts)
              </ol>
balloon hover = sub {
		my $f = shift;
                my $id = $f->load_id;
		my $name = $f->name;
                my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;

                my @tags = $f->get_all_tags;

                # Order of the tags in the tags array
                #tag0 = Alias
                #tag1 = source
                #tag2 = end_conf
                #tag3 = div_5NFR
                #tag4 = init_3NFR_same
                #tag5 = load_id
                #tag6 = init_3NFR_opp
                #tag7 = tan_5NFR
                
                my ($div_5NFR) = $f->get_tag_values($tags[3]);
                my ($tan_5NFR) = $f->get_tag_values($tags[7]);
                my ($init_3NFR_opp) = $f->get_tag_values($tags[6]);
                my ($init_3NFR_same) = $f->get_tag_values($tags[4]);

            	my @data;

		push @data, { Key => 'Description:', Value => "$name ($id)" };
		push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                push @data, { Key => 'Shares 5\'NFR in divergent configuration with:', Value => "$div_5NFR" };
                push @data, { Key => 'Shares 5\'NFR in tandem with:', Value => "$tan_5NFR" };
                push @data, { Key => 'Initiates from 3\'NFR of and opposite strand to:', Value => "$init_3NFR_opp" };
                push @data, { Key => 'Initiates from 3\'NFR of and same strand to:', Value => "$init_3NFR_same" };
                hover("Source: Xu et al. (2009) Nature 457(7232):1033-7", \@data);
                }

[Yassour 2009 UTRs]
database        = encode
feature         = five_prime_UTR:Yassour_2009 three_prime_UTR:Yassour_2009
glyph           = segments
stranded        = 1
bgcolor         = green
fgcolor         = black
label           = 1
height          = 6
category        = Gene Structure:UTRs
key             = 5' and 3' UTRs: Yassour et al. (2009)
citation	= <b>Yassour M, Kaplan T, Fraser HB, Levin JZ, Pfiffner J, Adiconis X, Schroth G, Luo S, Khrebtukova I, Gnirke A, Nusbaum C, Thompson DA, Friedman N, Regev A. (2009)
                  Ab initio construction of a eukaryotic transcriptome by massively parallel mRNA sequencing. Proc Natl Acad Sci USA 106(9):3264-9.
                  <a href="http://www.ncbi.nlm.nih.gov/pubmed/19208812">[PMID:19208812]</a></b><br/><br/>
                  Yassour et al. devised a general approach for ab initio discovery of the complete transcriptome using RNA-seq and only the unannotated S. cerevisiae genome sequence to automatically construct a highly accurate transcript catalog.
                  These features represent ab initio predicted 5' and 3' UTR boundaries.
balloon hover	= sub {
		my $f = shift;
		my $name = $f->name;
                my @aliases = $f->aliases;
                my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;
		my @data;
		push @data, { Key => 'Description:', Value => "$name ($aliases[0])" };
		push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                hover("Source: Yassour et al. (2009) Proc Natl Acad Sci USA 106(9):3264-9", \@data);
                }

[Yassour 2009 ab initio transcripts]
database        = encode
feature         = transcript:Yassour_2009
glyph           = segments
stranded        = 1
bgcolor         = magenta
fgcolor         = black
label           = 1
height          = 6
category        = RNA Expression Profiling:mRNA:RNA-seq
key             = Transcribed regions (ab initio): Yassour et al. (2009)
citation	= <b>Yassour M, Kaplan T, Fraser HB, Levin JZ, Pfiffner J, Adiconis X, Schroth G, Luo S, Khrebtukova I, Gnirke A, Nusbaum C, Thompson DA, Friedman N, Regev A. (2009)
                  Ab initio construction of a eukaryotic transcriptome by massively parallel mRNA sequencing. Proc Natl Acad Sci USA 106(9):3264-9.
                  <a href="http://www.ncbi.nlm.nih.gov/pubmed/19208812">[PMID:19208812]</a></b><br/><br/>
                  Yassour et al. devised a general approach for ab initio discovery of the complete transcriptome using RNA-seq and only the unannotated S. cerevisiae genome sequence to automatically construct a highly accurate transcript catalog. 
                  These features represent ab initio transcribed region predictions.
balloon hover	= sub {
		my $f = shift;
		my $name = $f->name;
                my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;
                my @ypd0 = $f->attributes('ypd0');
                my @ypd15 = $f->attributes('ypd15');
                my @hs15 = $f->attributes('hs15');
                my @hs_ypd = $f->attributes('hs/ypd');
                my @conserv = $f->attributes('conservation');
                my @notes = $f->notes;
		my @data;
		push @data, { Key => 'Description:', Value => "$name, (@notes)" };
                push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                push @data, { Key => 'Expression level in YPD, time 0, 22C (reads per kb):', Value => "@ypd0" };
                push @data, { Key => 'Expression level in YPD, time 15, 22C (reads per kb):', Value => "@ypd15" };
                push @data, { Key => 'Expression level in YPD, time 15, 37C (reads per kb):', Value => "@hs15" };
                push @data, { Key => 'Relative expression level (over both conditions):', Value => "@hs_ypd" };
                push @data, { Key => 'Conservation across 7 yeast species:', Value => "@conserv" };
                hover("Source: Yassour et al. (2009) Proc Natl Acad Sci USA 106(9):3264-9", \@data);
                }

[Granovskaia 2010 mitotic transcripts]
database        = encode
feature         = transcript_region:Granovskaia_2010
glyph           = transcript
stranded        = 1
bgcolor         = magenta
fgcolor         = black
height          = 6
label           = 1
category        = RNA Expression Profiling:Cell Cycle
key             = Mitotic transcriptome: Granovskaia et al. (2010)
citation        = <b>Granovskaia MV, Jensen LJ, Ritchie ME, Toedling J, Ning Y, Bork P, Huber W, Steinmetz LM. (2010)
                  High-resolution transcription atlas of the mitotic cell cycle in budding yeast. Genome Biol. 2010;11(3):R24.
                  <a href="http://www.ncbi.nlm.nih.gov/pubmed/20193063">[PMID:20193063]</a></b><br/><br/>
                  Granovskaia et al. used 8bp tiling arrays to generate a 5 minute resolution, strand-specific atlas of transcriptome during the S. cerevisiae cell cycle.
balloon hover    = sub {
	         my $f = shift;
		 my $name = $f->name;
                 my $ref = $f->seq_id;
		 my $beg = $f->start;
		 my $end = $f->end;
                 my ($length) = $f->attributes('length');
                 my ($peak_time) = $f->attributes('expression_peak_time');
                 my ($type) = $f->attributes('type');
                 my @data;
                 push @data, { Key => 'Description:', Value => "$name" };
                 push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                 push @data, { Key => 'Length:', Value => "$length" };
                 push @data, { Key => 'Expression peak time (min):', Value => "$peak_time" };
                 push @data, { Key => 'Transcript type:', Value => "$type" };
                 hover("Source: Mancera et al. (2008) Nature. 2008 Jul 24;454(7203):479-85.", \@data);
                 }

[Zhang 2007 intron tilling array]
database         = encode
feature          = microarray_oligo:Zhang_2007
glyph            = vista_plot
glyph_subtype    = both
graph_type       = histogram
label            = 1
smoothing        = mean
smoothing_window = 10
bump density     = 250
autoscale       = local
variance_band   = 1
max_peak        = 3
min_peak        = -1
peakwidth       = 8
start_color     = lightgray
end_color       = black
pos_color       = blue
neg_color       = orange
bgcolor         = orange
alpha           = 80
fgcolor         = black
box_subparts     = 1
bicolor_pivot    = 0
category         = Gene Structure:Gene Models:Introns 
key              = Intron tiling array log2 ratios, dbr1/DBR1+: Zhang et al. (2007)
citation         = <b>Zhang Z, Hesselberth JR, Fields S. (2007) Genome-wide identification of spliced introns using a tiling microarray. Genome Res. 2007 Apr;17(4):503-9.
                   <a href="http://www.ncbi.nlm.nih.gov/pubmed/17351133">[PMID:17351133]</a></b><br/><br/>
                   Zhang et al. used tiling arrays to identify spliced introns by detecting the accumulation of lariats from labelled cDNA derived from total RNA from diploid dbr1/dbr1 and DBR+/DBR+ S. cerevisiae strains.
balloon hover    = sub {
	         my $f = shift;
		 my $name = $f->name;
                 my $ref = $f->seq_id;
		 my $beg = $f->start;
		 my $end = $f->end;
                 my @data;
                 push @data, { Key => 'Description:', Value => "$name" };
                 push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                 hover("Source: Zhang et al. (2007) Genome Res. 2007 Apr;17(4):503-9.", \@data);
                 }

[Zhang 2007 intron tilling array:100001]
glyph            = vista_plot
glyph_subtype    = density
label            = 0

[Eaton 2010 ACS]
database        = encode
feature         = DNA_motif:Eaton_2010
glyph           = segments
stranded        = 1
fgcolor         = black
bgcolor         = pink
label           = 1
height          = 6
category        = Replication and Recombination:Origins of Replication
key             = ORC-ARS consensus sequences: Eaton et al. (2010)
citation        = <b>Eaton ML, Galani K, Kang S, Bell SP, MacAlpine DM. (2010) Conserved nucleosome positioning defines replication origins. Genes Dev. 2010 Apr 15;24(8):748-53
                  <a href="http://www.ncbi.nlm.nih.gov/pubmed/20351051">[PMID:20351051]</a></b><br/><br/>
                  Eaton et al. applied high-throughput sequencing to map ORC binding and nucleosome positioning in S. cerevisiae to study yeast replication origins genome-wide. 
                  These features represent the 253 likely ORC-binding location associated ARS consensus sequences found by motif analysis on the ORC ChIP-peaks identified in this study.
balloon hover	= sub {
		my $f = shift;
		my $name = $f->name;
                my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;
                my ($score) = $f->attributes('motif_score');
                my @data;
                push @data, { Key => 'Description:', Value => "$name" };
                push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                push @data, { Key => 'ACS motif match score:', Value => "$score" };
                hover("Source: Eaton et al. (2010) Genes Dev. 2010 Apr 15;24(8):748-53", \@data);
                }

## Replication and recombination ##

[Eaton 2010 nucleosome]
database        = encode
feature         = histone_binding_site:Eaton_2010
subtrack select = Expt tag_value expt ;
subtrack table  = :orc1_mut orc1_mutant * ;
                 :WT_async WT_asynchronous  ;
                 :WT_G1 WT_G1_arrested  ;
                 :WT_G2 WT_G2_arrested  ;
subtrack select labels = orc1_mutant "orc1 mutant" ;
                         WT_asynchronous "WT, asynchronous" ;
                         WT_G1_arrested "WT, G1 arrested" ;
                         WT_G2_arrested "WT, G2 arrested" ;
glyph           = segments
height          = 6
bump density    = 300
fgcolor         = black
bgcolor         = blue
category        = Replication and Recombination:Origins of Replication
key             = Mononucleosomes: Eaton et al. (2010)
label           = 1
citation        = <b>Eaton ML, Galani K, Kang S, Bell SP, MacAlpine DM. (2010) Conserved nucleosome positioning defines replication origins. Genes Dev. 2010 Apr 15;24(8):748-53
                  <a href="http://www.ncbi.nlm.nih.gov/pubmed/20351051">[PMID:20351051]</a></b><br/><br/>
                  Eaton et al. applied high-throughput sequencing to map ORC binding and nucleosome positioning in S. cerevisiae to study yeast replication origins genome-wide. 
                  These features represent the sequenced mononucleosome fragments following the digestion of the following types of cells with micrococcal nuclease:
                  <ol>
                    <li> orc-1 mutant
                    <li> WT, asynchronous
                    <li> WT, G1 arrested
                    <li> WT, G2 arrested
                  </ol>
                  The nucleosome score represents the score of the putative nucleosome, when compared to the maximum nucleosome score of twenty in silico sequencing simulations
                  with uniform read density across the genome. It is the sum of the sequencing reads that contribute to a nucleosome edge, weighted by a gaussian distribution 
                  of standard deviation 20 and a mean centered on the edge of the nucleosome, summed over the two edges.
balloon hover   = sub {
		my $f = shift;
		my $name = $f->name;
                my $ref = $f->seq_id;
		my $beg = $f->start;
		my $end = $f->end;
                my ($dyad) = $f->attributes('dyad_position');
                my ($score) = $f->attributes('nucleosome_score');
                my ($expt) = $f->attributes('expt');
                my @data;
                push @data, { Key => 'Description:', Value => "$name" };
                push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                push @data, { Key => 'Nucleosome score:', Value => "$score" };
                push @data, { Key => 'Experiment:', Value => "$expt" };
                hover("Source: Eaton et al. (2010) Genes Dev. 2010 Apr 15;24(8):748-53", \@data);
                }

[Xu 2006 nimARS and nimACS]
database         = encode
feature          = ARS:Xu_2006 DNA_motif:Xu_2006
glyph            = segments
fgcolor          = black
bgcolor          = pink
label            = 1
height           = 6
category         = Replication and Recombination:Origins of Replication
key              = Known and predicted ARSs and ACSs: Xu et al. (2006)
citation         = <b>Xu W, Aparicio JG, Aparicio OM, Tavar&eacute S. (2006) Genome-wide mapping of ORC and Mcm2p binding sites
                   on tiling arrays and identification of essential ARS consensus sequences in S. cerevisiae BMC Genomics. 2006 Oct 26;7:276.
                   <a href="http://www.ncbi.nlm.nih.gov/pubmed/17067396">[PMID:17067396]</a></b><br/><br/>
                   Xu et al. used tiling arrays to map ORC and Mcm2p binding sites to identify essential replication origin sequences genome-wide at high resolution
                   and defined a set of potential Autonomously Replicating Sequences (ARSs).
balloon hover    = sub {
	         my $f = shift;
		 my $name = $f->name;
                 my $ref = $f->seq_id;
		 my $beg = $f->start;
		 my $end = $f->end;
                 my @data;
                 push @data, { Key => 'Description:', Value => "$name" };
                 push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                 hover("Source: Xu et al. (2006) BMC Genomics. 2006 Oct 26;7:276", \@data);
                 }

[Xu 2006 MCM2 and ORC ChIP chip]
database         = encode
feature          = microarray_oligo:Xu_2006
subtrack select  = Peak_type tag_value peak_type
subtrack table   = :MCM2 protein_binding_site:Xu_2006_MCM2  ;
                   :ORC protein_binding_site:Xu_2006_ORC ;
subtrack select labels = protein_binding_site:Xu_2006_MCM2 "MCM2 ChIP" ;
                         protein_binding_site:Xu_2006_ORC  "ORC ChIP" ;
glyph            = vista_plot
glyph_subtype    = vista
graph_type       = histogram
label            = 1
smoothing        = mean
smoothing_window = 10
bump density     = 250
autoscale        = local
#variance_band    = 1
max_peak         = 5
min_peak         = -1
peakwidth        = 8
start_color      = lightgray
end_color        = black
pos_color        = blue
neg_color        = orange
bgcolor          = orange
alpha            = 80
fgcolor          = black
box_subparts     = 1
bicolor_pivot    = 0
category         = Replication and Recombination:Origins of Replication
key              = MCM2 and ORC ChIP chip: Xu et al. (2006)
citation         = <b>Xu W, Aparicio JG, Aparicio OM, Tavar&eacute S. (2006) BMC Genomics. Genome-wide mapping of ORC and Mcm2p binding sites
                   on tiling arrays and identification of essential ARS consensus sequences in S. cerevisiae 2006 Oct 26;7:276.
                   <a href="http://www.ncbi.nlm.nih.gov/pubmed/17067396">[PMID:17067396]</a></b><br/><br/>
                   Xu et al. used tiling arrays to map ORC and Mcm2p binding sites to identify essential replication origin sequences genome-wide at high resolution
                   and defined a set of potential Autonomously Replicating Sequences (ARSs).
balloon hover    = sub {
	         my $f = shift;
		 my $name = $f->name;
                 my $ref = $f->seq_id;
		 my $beg = $f->start;
		 my $end = $f->end;
                 my ($num_probes) = $f->attributes("num_probes");
                 my @data;
                 push @data, { Key => 'Description:', Value => "$name" };
                 push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                 hover("Source: Xu et al. (2006) BMC Genomics. 2006 Oct 26;7:276", \@data);
                 }

[Mancera 2008 recombination hotspots]
database        = encode
feature         = recombination_hotspot:Mancera_2008
glyph           = span
stranded        = 0
bgcolor         = black
fgcolor         = black
label           = 1
height          = 6
category        = Replication and Recombination:Meiotic Recombination
key             = Recombination Hotspots: Mancera et al. (2008)
citation         = <b>Mancera E, Bourgon R, Brozzi A, Huber W, Steinmetz LM. (2008) High-resolution mapping of meiotic crossovers and non-crossovers in yeast. Nature. 2008 Jul 24;454(7203):479-85.
                   <a href="http://www.ncbi.nlm.nih.gov/pubmed/18615017">[PMID:18615017]</a></b><br/><br/>
                   Mancera et al. used dense genetic marker data collected from all four products of 56 S. cerevisiae meioses using tiling arrays to generate maps of crossovers, 
                   crossover-associated gene conversion and non-crossover gene conversion in their study.
balloon hover    = sub {
	         my $f = shift;
		 my $name = $f->name;
                 my $ref = $f->seq_id;
		 my $beg = $f->start;
		 my $end = $f->end;
                 my ($type) = $f->attributes('type');
                 my @data;
                 push @data, { Key => 'Description:', Value => "$name" };
                 push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                 push @data, { Key => 'Event type:', Value => "$type" };
                 hover("Source: Mancera et al. (2008) Nature. 2008 Jul 24;454(7203):479-85.", \@data);
                 }

[Qi 2009 meiotic crossovers]
database        = encode
feature         = recombination_feature:Qi_2009
glyph           = span
stranded        = 0
bgcolor         = black
fgcolor         = black
height          = 6
label           = 1
category        = Replication and Recombination:Meiotic Recombination
key             = Recombination Events: Qi et al. (2009)
citation        = <b>Qi J, Wijeratne AJ, Tomsho LP, Hu Y, Schuster SC, Ma H. (2009)
                  Characterization of meiotic crossovers and gene conversion by whole-genome sequencing in Saccharomyces cerevisiae. BMC Genomics. 2009 Oct 15;10:475.
                  <a href="http://www.ncbi.nlm.nih.gov/pubmed/19832984">[PMID:19832984]</a></b><br/><br/>
                  Qi et al. crossed S288C with RM11 to obtain a diploid with a large number of sequence polymorphisms and induced meiosis to obtain a
                  number of tetrads with meiotic spores. One set of four spores was cultured in rich medium, and their DNA sequenced using the
                  454 technology to investigate meiotic recombination events at high resolution.
balloon hover    = sub {
	         my $f = shift;
		 my $name = $f->name;
                 my $ref = $f->seq_id;
		 my $beg = $f->start;
		 my $end = $f->end;
                 my ($type) = $f->attributes('type');
                 my @data;
                 push @data, { Key => 'Description:', Value => "$name" };
                 push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                 push @data, { Key => 'Event type:', Value => "$type" };
                 hover("Source: Qi et al. (2009) BMC Genomics. 2009 Oct 15;10:475.", \@data);
                 }
                  
[Buhler 2007 DSB hotspots]
database         = encode
feature          = microarray_oligo:Buhler_2007
subtrack select  = Peak_type tag_value peak_type
subtrack table   = :dmc1del biological_region:Buhler_2007_dmc1delta_5x ;
                   :rad50S biological_region:Buhler_2007_rad50S_5x ;
                   :dmc1del_rad51del biological_region:Buhler_2007_rad51delta_dmc1delta_5x ;
subtrack select labels = biological_region:Buhler_2007_dmc1delta_5x "dmc1del mutant" ;
                         biological_region:Buhler_2007_rad50S_5x "rad50S mutant" ;
                         biological_region:Buhler_2007_rad51delta_dmc1delta_5x "dmc1del rad51del mutant" ;
glyph            = vista_plot
glyph_subtype    = both
graph_type       = histogram
label            = 0
smoothing        = mean
smoothing_window = 10
bump density     = 250
autoscale        = local
variance_band    = 1
peakwidth        = 8
start_color      = lightgray
end_color        = black
pos_color        = blue
neg_color        = orange
bgcolor          = orange
alpha            = 80
fgcolor          = black
box_subparts     = 1
bicolor_pivot    = min
category         = Replication and Recombination:Meiotic Recombination 
key              = Double strand break hotspots: Buhler et al. (2007)
citation         = <b>Buhler C, Borde V, Lichten M. (2007) Mapping meiotic single-strand DNA reveals a new landscape of DNA double-strand breaks in Saccharomyces cerevisiae. PLoS Biol. 2007 Dec;5(12):e324.
                   <a href="http://www.ncbi.nlm.nih.gov/pubmed/18076285">[PMID:18076285]</a></b><br/><br/>
                   Buhler et al. developed a method to map single-strand DNA-associated double strand breaks (DSBs) after removal of Spo11 in processing-capable, repair-defective dmc1Delta and dmc1Delta rad51Delta mutants genome-wide in S. cerevisiae.
balloon hover    = sub {
	         my $f = shift;
		 my $name = $f->name;
                 my $ref = $f->seq_id;
		 my $beg = $f->start;
		 my $end = $f->end;
                 my ($score) = $f->attributes("normalized_intensity");
                 if ($score eq ""){
                   $score = "N/A";
                 }
                 my @data;
                 push @data, { Key => 'Description:', Value => "$name" };
                 push @data, { Key => 'Coordinates:', Value => "$ref\:$beg\.\.$end" };
                 push @data, { Key => 'Normalized array intensity value:', Value => "$score" };
                 hover("Source: Buhler et al. (2007) Genome Res. 2007 Apr;17(4):503-9.", \@data);
                 }

[Buhler 2007 DSB hotspots:100001]
glyph            = vista_plot
glyph_subtype    = density
label            = 0

[OligoFinder:plugin]
search_segments	= ChrI ChrII ChrIII ChrIV ChrV ChrVI ChrVII ChrVIII ChrIX ChrX ChrXI ChrXII ChrXIII ChrXIV ChrXV ChrXVI ChrMito

[ExportFeatures:plugin]
editor		= Artemis
aggregator = on


